# Force HTTPS (HSTS)
Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

# Prevent session fixation and session hijacking
php_value session.cookie_secure 1
php_value session.cookie_httponly 1
php_value session.use_only_cookies 1
php_value session.cookie_samesite "Lax"

# Disable passing session ID via URL
php_value session.use_trans_sid 0

# Disable display of errors in production
php_value display_errors Off
php_value log_errors On
php_value error_log /path/to/your/error_log

# Block access to sensitive files
<FilesMatch "^.*\.(htaccess|env|ini|log|conf|php|phar)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Set session file permissions
<Directory "/path/to/php/sessions">
    Order Deny,Allow
    Deny from all
</Directory>

# Limit file uploads
php_value upload_max_filesize 5M
php_value post_max_size 5M

# Set Content Security Policy (CSP)
Header set Content-Security-Policy "default-src 'self'; script-src 'self'; object-src 'none';"
